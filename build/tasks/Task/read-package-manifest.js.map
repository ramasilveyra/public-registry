{"version":3,"sources":["../../../src/tasks/Task/read-package-manifest.js"],"names":["readFile","bluebird","promisify","fs","readPackageManifest","pkgPath","packagePath","path","resolve","pkg","JSON","parse","scripts","validatePackageJSON","name","Error","version","semver","valid"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;;;AAEA,MAAMA,QAAQ,GAAGC,kBAASC,SAAT,CAAmBC,YAAGH,QAAtB,CAAjB;;AAEe,eAAeI,mBAAf,CAAmCC,OAAnC,EAA4C;AACzD,QAAMC,WAAW,GAAGC,cAAKC,OAAL,CAAaH,OAAb,EAAsB,cAAtB,CAApB;;AACA,QAAMI,GAAG,GAAGC,IAAI,CAACC,KAAL,EAAW,MAAMX,QAAQ,CAACM,WAAD,EAAc,OAAd,CAAzB,EAAZ;AACAG,EAAAA,GAAG,CAACG,OAAJ,GAAcH,GAAG,CAACG,OAAJ,IAAe,EAA7B;AACAC,EAAAA,mBAAmB,CAACJ,GAAD,CAAnB;AACA,SAAOA,GAAP;AACD;;AAED,SAASI,mBAAT,CAA6BJ,GAA7B,EAAkC;AAChC,MAAI,CAACA,GAAG,CAACK,IAAT,EAAe;AACb,UAAM,IAAIC,KAAJ,CAAU,8BAAV,CAAN;AACD;;AAED,MAAI,CAACN,GAAG,CAACO,OAAT,EAAkB;AAChB,UAAM,IAAID,KAAJ,CAAU,iCAAV,CAAN;AACD;;AAED,MAAI,CAACE,gBAAOC,KAAP,CAAaT,GAAG,CAACO,OAAjB,CAAL,EAAgC;AAC9B,UAAM,IAAID,KAAJ,CAAU,yBAAV,CAAN;AACD;AACF","sourcesContent":["import fs from 'fs';\nimport path from 'path';\nimport bluebird from 'bluebird';\nimport semver from 'semver';\n\nconst readFile = bluebird.promisify(fs.readFile);\n\nexport default async function readPackageManifest(pkgPath) {\n  const packagePath = path.resolve(pkgPath, 'package.json');\n  const pkg = JSON.parse(await readFile(packagePath, 'utf-8'));\n  pkg.scripts = pkg.scripts || {};\n  validatePackageJSON(pkg);\n  return pkg;\n}\n\nfunction validatePackageJSON(pkg) {\n  if (!pkg.name) {\n    throw new Error(\"Package doesn't have a name.\");\n  }\n\n  if (!pkg.version) {\n    throw new Error(\"Package doesn't have a version.\");\n  }\n\n  if (!semver.valid(pkg.version)) {\n    throw new Error('Invalid semver version.');\n  }\n}\n"],"file":"read-package-manifest.js"}