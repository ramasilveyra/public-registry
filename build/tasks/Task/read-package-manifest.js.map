{"version":3,"file":"read-package-manifest.js","names":["readFile","bluebird","promisify","fs","readPackageManifest","pkgPath","packagePath","path","resolve","pkg","JSON","parse","scripts","validatePackageJSON","name","Error","version","semver","valid"],"sources":["../../../src/tasks/Task/read-package-manifest.js"],"sourcesContent":["import fs from 'fs';\nimport path from 'path';\nimport bluebird from 'bluebird';\nimport semver from 'semver';\n\nconst readFile = bluebird.promisify(fs.readFile);\n\nexport default async function readPackageManifest(pkgPath) {\n  const packagePath = path.resolve(pkgPath, 'package.json');\n  const pkg = JSON.parse(await readFile(packagePath, 'utf-8'));\n  pkg.scripts = pkg.scripts || {};\n  validatePackageJSON(pkg);\n  return pkg;\n}\n\nfunction validatePackageJSON(pkg) {\n  if (!pkg.name) {\n    throw new Error(\"Package doesn't have a name.\");\n  }\n\n  if (!pkg.version) {\n    throw new Error(\"Package doesn't have a version.\");\n  }\n\n  if (!semver.valid(pkg.version)) {\n    throw new Error('Invalid semver version.');\n  }\n}\n"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;;;AAEA,MAAMA,QAAQ,GAAGC,iBAAA,CAASC,SAAT,CAAmBC,WAAA,CAAGH,QAAtB,CAAjB;;AAEe,eAAeI,mBAAf,CAAmCC,OAAnC,EAA4C;EACzD,MAAMC,WAAW,GAAGC,aAAA,CAAKC,OAAL,CAAaH,OAAb,EAAsB,cAAtB,CAApB;;EACA,MAAMI,GAAG,GAAGC,IAAI,CAACC,KAAL,CAAW,MAAMX,QAAQ,CAACM,WAAD,EAAc,OAAd,CAAzB,CAAZ;EACAG,GAAG,CAACG,OAAJ,GAAcH,GAAG,CAACG,OAAJ,IAAe,EAA7B;EACAC,mBAAmB,CAACJ,GAAD,CAAnB;EACA,OAAOA,GAAP;AACD;;AAED,SAASI,mBAAT,CAA6BJ,GAA7B,EAAkC;EAChC,IAAI,CAACA,GAAG,CAACK,IAAT,EAAe;IACb,MAAM,IAAIC,KAAJ,CAAU,8BAAV,CAAN;EACD;;EAED,IAAI,CAACN,GAAG,CAACO,OAAT,EAAkB;IAChB,MAAM,IAAID,KAAJ,CAAU,iCAAV,CAAN;EACD;;EAED,IAAI,CAACE,eAAA,CAAOC,KAAP,CAAaT,GAAG,CAACO,OAAjB,CAAL,EAAgC;IAC9B,MAAM,IAAID,KAAJ,CAAU,yBAAV,CAAN;EACD;AACF"}