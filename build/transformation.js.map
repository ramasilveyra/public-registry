{"version":3,"sources":["../src/transformation.js"],"names":["t","transformation","oldAst","inputFilePath","newAst","table","components","dependencies","reactComponentVisitor","JSXElement","path","tagName","node","openingElement","name","isFromDependency","isUsedAsRC","element","context","getContext","setContext","JSXText","elems","value","text","JSXExpressionContainer","isJSXAttribute","parent","expressionPath","get","expressionNode","isLogicalExpression","operator","isConditionalExpression","isMapIterator","interpolationEscaped","JSXAttribute","valueNode","shouldIgnoreAttr","attribute","isBoolean","isStringLiteral","isString","expression","styles","properties","forEach","prop","key","stringInlineStyles","valuePath","CallExpression","isIterator","iterablePath","currentValuePath","indexPath","arrayPath","iteration","LogicalExpression","test","findParent","left","condition","testPath","consequent","ConditionalExpression","ignoreConsequent","isNullLiteral","replaceWith","UnaryExpression","StringLiteral","generalVisitor","ImportDeclaration","source","specifier","specifiers","find","isImportDefaultSpecifier","local","requiredFrom","VariableDeclaration","checkForReactComponent","FunctionDeclaration","ExportDefaultDeclaration","exportedComponent","declaration","component","defaultExport","ObjectExpression","isAssignmentExpression","isMemberExpression","isObjectExpression","right","isIdentifier","object","property","isPropTypes","isDefaultProps","componentName","definitions","map","index","createDefinition","definition","mainComponent","Object","values","ast","is","isFunctionDeclaration","isExportDefaultDeclaration","props","mixin","createdFrom","traverse","_context","pathItem","callee","includes","newDef","assign","isRequired","defaultPath"],"mappings":"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","file":"transformation.js","sourcesContent":["/* eslint-disable no-underscore-dangle, no-param-reassign */\nimport babelTraverse from '@babel/traverse';\nimport * as t from '@babel/types';\nimport cleanJSXElementLiteralChild from '@babel/types/lib/utils/react/cleanJSXElementLiteralChild';\nimport {\n  createAttribute,\n  createCondition,\n  createElement,\n  createInterpolationEscaped,\n  createIteration,\n  createMixin,\n  createRoot,\n  createText\n} from './ast';\nimport isFunctionalReactComponent from './utils/is-functional-react-component';\nimport getReactComponentName from './utils/get-react-component-name';\nimport addToContext from './utils/add-to-context';\nimport getReactComponentProps from './utils/get-react-component-props';\nimport inlineStyles from './utils/inline-styles';\n\nfunction transformation(oldAst, inputFilePath) {\n  const newAst = createRoot();\n  const table = { components: {}, dependencies: {} };\n\n  const reactComponentVisitor = {\n    JSXElement(path) {\n      const tagName = path.node.openingElement.name.name;\n      const isFromDependency = table.dependencies[tagName];\n      if (isFromDependency) {\n        isFromDependency.isUsedAsRC = true;\n      }\n      const element = createElement(tagName);\n      const context = getContext(path);\n      addToContext(context, element);\n      setContext(path, element);\n    },\n    JSXText(path) {\n      const elems = [];\n      cleanJSXElementLiteralChild(path.node, elems);\n      const value = elems[0] ? elems[0].value : '';\n      if (!value) {\n        return;\n      }\n      const text = createText(value);\n      const context = getContext(path);\n      addToContext(context, text);\n    },\n    JSXExpressionContainer(path) {\n      // Let JSXAttribute visitor handle JSXExpressionContainer of attributes.\n      if (t.isJSXAttribute(path.parent)) {\n        return;\n      }\n\n      const expressionPath = path.get('expression');\n      const expressionNode = expressionPath.node;\n\n      if (t.isLogicalExpression(expressionNode, { operator: '&&' })) {\n        return;\n      }\n      if (t.isLogicalExpression(expressionNode, { operator: '||' })) {\n        return;\n      }\n      if (t.isConditionalExpression(expressionNode)) {\n        return;\n      }\n      if (isMapIterator(expressionNode)) {\n        return;\n      }\n\n      const context = getContext(path);\n      const interpolationEscaped = createInterpolationEscaped(expressionPath);\n      addToContext(context, interpolationEscaped);\n    },\n    JSXAttribute(path) {\n      const context = getContext(path);\n      const name = path.node.name.name;\n      const valueNode = path.node.value;\n      if (shouldIgnoreAttr(name)) {\n        return;\n      }\n      if (!valueNode) {\n        const attribute = createAttribute({ name, value: true, isBoolean: true });\n        addToContext(context, attribute, 'attributes');\n        return;\n      }\n      if (t.isStringLiteral(valueNode)) {\n        const attribute = createAttribute({ name, value: valueNode.value, isString: true });\n        addToContext(context, attribute, 'attributes');\n        return;\n      }\n      const expression = path.get('value.expression');\n      if (name === 'style') {\n        const styles = {};\n        expression.node.properties.forEach(prop => {\n          styles[prop.key.name] = prop.value.value;\n        });\n        const stringInlineStyles = inlineStyles(styles);\n        if (stringInlineStyles) {\n          const attribute = createAttribute({ name, value: stringInlineStyles, isString: true });\n          addToContext(context, attribute, 'attributes');\n        }\n        return;\n      }\n      const attribute = createAttribute({ name, valuePath: expression });\n      addToContext(context, attribute, 'attributes');\n    },\n    CallExpression(path) {\n      const isIterator = isMapIterator(path.node);\n      if (isIterator) {\n        const iterablePath = path.get('callee.object');\n        const currentValuePath = path.get('arguments.0.params.0');\n        const indexPath = path.get('arguments.0.params.1');\n        const arrayPath = path.get('arguments.0.params.2');\n        const iteration = createIteration({ iterablePath, currentValuePath, indexPath, arrayPath });\n        const context = getContext(path);\n        addToContext(context, iteration);\n        setContext(path, iteration);\n      }\n    },\n    LogicalExpression(path) {\n      if (t.isConditionalExpression(path.parent) && path.parent.test === path.node) {\n        return;\n      }\n      if (path.findParent(node => t.isJSXAttribute(node)) || t.isLogicalExpression(path.parent)) {\n        return;\n      }\n      const left = path.get('left');\n      const context = getContext(path);\n      if (path.node.operator === '&&') {\n        const condition = createCondition({ testPath: left });\n        addToContext(context, condition);\n        setContext(path, condition);\n        return;\n      }\n      const interpolationEscaped = createInterpolationEscaped(left);\n      const condition = createCondition({ testPath: left, consequent: interpolationEscaped });\n      addToContext(context, condition);\n      setContext(path, condition);\n    },\n    ConditionalExpression(path) {\n      if (path.findParent(node => t.isJSXAttribute(node))) {\n        return;\n      }\n      const testPath = path.get('test');\n      const context = getContext(path);\n      const ignoreConsequent = t.isNullLiteral(path.node.consequent);\n      if (ignoreConsequent) {\n        testPath.replaceWith(t.UnaryExpression('!', testPath.node));\n      }\n      const condition = createCondition({ testPath });\n      addToContext(context, condition);\n      setContext(path, condition);\n    },\n    StringLiteral(path) {\n      if (path.findParent(node => t.isJSXAttribute(node))) {\n        return;\n      }\n      if (t.isConditionalExpression(path.parent)) {\n        const context = getContext(path);\n        const text = createText(path.node.value);\n        addToContext(context, text);\n      }\n    }\n  };\n\n  const generalVisitor = {\n    ImportDeclaration(path) {\n      const source = path.node.source.value;\n      const specifier = path.node.specifiers.find(node => t.isImportDefaultSpecifier(node)).local\n        .name;\n      table.dependencies[specifier] = { source, requiredFrom: inputFilePath };\n    },\n    VariableDeclaration(path) {\n      checkForReactComponent(path);\n    },\n    FunctionDeclaration(path) {\n      checkForReactComponent(path);\n    },\n    ExportDefaultDeclaration(path) {\n      const exportedComponent = path.node.declaration.name;\n      const component = table.components[exportedComponent];\n      if (component) {\n        component.defaultExport = true;\n      }\n    },\n    ObjectExpression(path) {\n      const parent = path.parent;\n      if (\n        !t.isAssignmentExpression(parent, { operator: '=' }) ||\n        !t.isMemberExpression(parent.left) ||\n        !t.isObjectExpression(parent.right) ||\n        !t.isIdentifier(parent.left.object) ||\n        !(\n          t.isIdentifier(parent.left.property, { name: 'propTypes' }) ||\n          t.isIdentifier(parent.left.property, { name: 'defaultProps' })\n        )\n      ) {\n        return;\n      }\n      const isPropTypes = t.isIdentifier(parent.left.property, { name: 'propTypes' });\n      const isDefaultProps = t.isIdentifier(parent.left.property, { name: 'defaultProps' });\n      const componentName = parent.left.object.name;\n      const component = table.components[componentName];\n      if (!component.definitions) {\n        component.definitions = path.node.properties.map((node, index) =>\n          createDefinition({ node, index, isPropTypes, isDefaultProps, path })\n        );\n      }\n      path.node.properties.forEach((node, index) => {\n        component.definitions = component.definitions.map(definition => {\n          if (definition.name === node.key.name) {\n            return createDefinition({ definition, node, index, isPropTypes, isDefaultProps, path });\n          }\n          return definition;\n        });\n      });\n    }\n  };\n\n  babelTraverse(oldAst, generalVisitor, null);\n\n  const mainComponent = Object.values(table.components).find(component => component.defaultExport);\n  addToContext(newAst, mainComponent.node);\n\n  return { ast: newAst, table };\n\n  function checkForReactComponent(path) {\n    const is = isFunctionalReactComponent(path);\n    const name = getReactComponentName(path.node);\n    const defaultExport = t.isFunctionDeclaration(path.node)\n      ? t.isExportDefaultDeclaration(path.parent)\n      : false;\n    const props = getReactComponentProps(path.node);\n    if (is) {\n      const mixin = createMixin(name, props);\n      setContext(path, mixin);\n      table.components[name] = {\n        node: mixin,\n        defaultExport,\n        createdFrom: inputFilePath\n      };\n      path.traverse(reactComponentVisitor);\n    }\n  }\n}\n\nexport default transformation;\n\nfunction setContext(path, context) {\n  path.node._context = context;\n}\n\nfunction getContext(path) {\n  const context = path.findParent(pathItem => !!pathItem.node._context).node._context;\n  return context;\n}\n\nfunction isMapIterator(node) {\n  const callee = node.callee;\n  if (!callee || !callee.property) {\n    return false;\n  }\n  const is = callee.property.name === 'map';\n  return is;\n}\n\nfunction shouldIgnoreAttr(name) {\n  if (['key', 'onClick', 'ref'].includes(name)) {\n    return true;\n  }\n  return false;\n}\n\nfunction createDefinition({ definition, node, index, isPropTypes, isDefaultProps, path }) {\n  const newDef = Object.assign({}, definition);\n  if (!newDef.name) {\n    newDef.name = node.key.name;\n  }\n  if (isPropTypes) {\n    newDef.isRequired =\n      t.isMemberExpression(node.value) &&\n      t.isIdentifier(node.value.property, { name: 'isRequired' });\n  }\n  if (isDefaultProps) {\n    newDef.defaultPath = path.get(`properties.${index}.value`);\n  }\n  return newDef;\n}\n"]}